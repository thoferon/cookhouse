-- Initial cookhouse.cabal generated by cabal init.  For further
-- documentation, see http://haskell.org/cabal/users-guide/

name:                  cookhouse
version:               0.1.0.0
synopsis:              An extensible build system
license:               BSD3
license-file:          LICENSE
author:                Thomas Feron
maintainer:            tho.feron@gmail.com
copyright:             Copyright (c) 2016 Thomas Feron
category:              Development
build-type:            Simple
cabal-version:         >=1.10

flag debugsql
  description:        Print SQL queries to stderr
  default:            False
  manual:             True

library
  hs-source-dirs:      src
  default-language:    Haskell2010
  ghc-options:         -Wall

  default-extensions:  ConstraintKinds
                       FlexibleContexts
                       OverloadedStrings
                       TypeFamilies
                       RecordWildCards
                       FlexibleInstances
                       GADTs
                       MultiParamTypeClasses

  exposed-modules:     Cookhouse
                       Cookhouse.Actions.Helpers
                       Cookhouse.Actions.JobActions
                       Cookhouse.Actions.PluginActions
                       Cookhouse.Actions.ProjectActions
                       Cookhouse.Actions.SessionActions
                       Cookhouse.Actions.Types
                       Cookhouse.App
                       Cookhouse.Capabilities
                       Cookhouse.Config
                       Cookhouse.Data.Internal
                       Cookhouse.Data.Job
                       Cookhouse.Data.Project
                       Cookhouse.Data.Types
                       Cookhouse.Environment
                       Cookhouse.Errors
                       Cookhouse.Logic.JobGeneration
                       Cookhouse.Middlewares.CORS
                       Cookhouse.Plugins.Source.Darcs
                       Cookhouse.Plugins.Trigger.SourceChange
                       Cookhouse.Plugins.Types
                       Cookhouse.Routes

  build-depends:       base >=4.8 && <4.9
                     , Spock
                     , aeson
                     , bytestring
                     , directory
                     , filepath
                     , free
                     , http-types
                     , mtl
                     , network-uri
                     , path-pieces
                     , postgresql-simple
                     , process
                     , resource-pool
                     , safe-access
                     , template-haskell
                     , text
                     , time
                     , unordered-containers
                     , vector
                     , wai
                     , yaml

test-suite unit-tests
  type:                exitcode-stdio-1.0
  main-is:             UnitTests.hs
  hs-source-dirs:      tests
  default-language:    Haskell2010
  ghc-options:         -Wall

  other-modules:       Cookhouse.Data.JobSpec
                       Cookhouse.Logic.JobGenerationSpec
                       Factory
                       SpecHelpers

  default-extensions:  ConstraintKinds
                       TypeFamilies
                       FlexibleContexts
                       FlexibleInstances
                       OverloadedStrings
                       RecordWildCards

  build-depends:       base
                     , cookhouse
                     , hspec
                     , QuickCheck
                     , mtl
                     , safe-access
                     , free
                     , time
                     , postgresql-simple
                     , bytestring
